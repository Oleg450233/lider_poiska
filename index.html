<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Лидер поиска</title>
    <link rel="stylesheet" href="css/main.css">
    <script src="https://kit.fontawesome.com/6da2f20eab.js" crossorigin="anonymous"></script>
</head>
<body>

<div class="container">

    <ul class="main_ul">
    <ul>
        <li><a href="index.php"><img src="image/lp_logo%201.png" alt=""></a></li>

    </ul>
    <ul class="last_ul" style="display: flex; align-items: center">
        <li><a href="bascet.php"><i class="fa-solid fa-basket-shopping "></i></a></li>
        <li class="basket"><a href="bascet.php" >Корзина </a></li>
        <li class="sum" ><span class="sum1" ></span></li>
    </ul>
    </ul>

<h1 style="text-align: center">Каталог товаров</h1>
<div class="catalog">

     <div id="1" class="catalog_image">
         <div class="img"><img src="image/image%201.jpg" alt=""></div>
         <div class="text">
             Увлажнитель воздуха
             STARWIND SHC1322, 3л, белый
         </div>
         <div class="price"><span class="price">1650</span> <span>₽</span></div>
         <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>

     </div>

    <div id="2" class="catalog_image">
        <div class="img"> <img src="image/image%202.jpg" alt=""></div>
        <div class="text">
            Триммер PHILIPS HC3521/15 <br>серебристый/черный
        </div>
        <div class="price"><span class="price">2290</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>

    <div id="3" class="catalog_image">
        <div class="img"><img src="image/image%203.jpg" alt=""></div>
        <div class="text">
            Фитнес-трекер HONOR Band 5 CRS-B19S, 0.95",
            розовый
        </div>
        <div class="price"><span class="price">2390</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="4" class="catalog_image">
        <div class="img"><img src="image/image%204.jpg" alt=""></div>
        <div class="text">
            Мышь A4TECH Bloody V3,
            игровая, оптическая,
            проводная, USB, черный
        </div>
        <div class="price"><span class="price">960</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="5" class="catalog_image">
        <div class="img"><img src="image/image%205.jpg" alt=""></div>
        <div class="text">
            Фитнес-трекер HONOR Band 5 CRS-B19S, 0.95",
            черный
        </div>
        <div class="price"><span class="price">2390 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="6" class="catalog_image">
        <div class="img"><img src="image/image%206.jpg" alt=""></div>
        <div class="text">
            Пылесос SINBO SVC 3497,
            2500Вт, синий/серый
        </div>
        <div class="price"><span class="price">5670</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="7" class="catalog_image">
        <div class="img"><img src="image/image%207.jpg" alt=""></div>
        <div class="text">
            Планшет DIGMA Optima
            7 Z800 Android 10.0 серебристый
        </div>
        <div class="price"><span class="price">9490</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="8" class="catalog_image">
        <div class="img"><img src="image/image%208.jpg" alt=""></div>
        <div class="text">
            Монитор игровой ACER Nitro RG241YPbiipx 23.8" черный
        </div>
        <div class="price"><span class="price">16800 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="9" class="catalog_image">
        <div class="img"><img src="image/image%209.jpg" alt=""></div>
        <div class="text">
            Экшн-камера DIGMA DiCam 310 4K, WiFi, черный
        </div>
        <div class="price"><span class="price">2290</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="10" class="catalog_image">
        <div class="img"><img src="image/image%2010.jpg" alt=""></div>
        <div class="text">
            Умная колонка ЯНДЕКС
            c голосовым помощником Алисой, серебристый
        </div>
        <div class="price"><span class="price">5670 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="11" class="catalog_image">
        <div class="img"><img src="image/image%2011.jpg" alt=""></div>
        <div class="text">
            Квадрокоптер DJI Mini 2
            MT2PD Fly More Combo <br>
            с камерой, серый
        </div>
        <div class="price"><span class="price">60990 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="12" class="catalog_image">
        <div class="img"><img src="image/image%2012.jpg" alt=""></div>
        <div class="text">
            Шлем виртуальной реальности HTC Vive PRO Eye EEA, черный/синий
        </div>
        <div class="price"><span class="price">11960 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="13" class="catalog_image">
        <div class="img"><img src="image/image%2013.jpg" alt=""></div>
        <div class="text">
            МФУ лазерный CANON i-Sensys MF445dw, A4, лазерный, черный
        </div>
        <div class="price"><span class="price">35310 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="14" class="catalog_image">
        <div class="img"><img src="image/image%2014.jpg" alt=""></div>
        <div class="text">
            Смарт-часы AMAZFIT Bip U, 1.43", зеленый / зеленый
        </div>
        <div class="price"><span class="price">4490</span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="15" class="catalog_image">
        <div class="img"><img src="image/image%2015.jpg" alt=""></div>
        <div class="text">
            Кофемашина PHILIPS
            EP1224/00, серый/черный
        </div>
        <div class="price"><span class="price">29990 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
    <div id="16" class="catalog_image">
        <div class="img"><img src="image/image%2016.jpg" alt=""></div>
        <div class="text">
            Гироскутер MIZAR MZ10,5CN, 10.5", карбон
        </div>
        <div class="price"><span class="price">12990 </span> <span>₽</span></div>
        <button data-action="button">ДОБАВИТЬ В КОРЗИНУ</button>
    </div>
</div>


</div>
</body>
</html>

<script>

    let block=document.querySelectorAll(".catalog_image");
    let text=document.querySelectorAll(".text");
    let price=document.querySelectorAll("div.price");
    let button=document.querySelectorAll("button");
    let sum=document.querySelector(".sum");
    let sum1=document.querySelector(".sum1");
    let number_order=window.localStorage.getItem('number_order');
    let img_basket=document.querySelector(".last_ul>li>a");
    let basket=document.querySelector(".basket>a");
    let basket1=document.querySelector(".last_ul>li:first-child>a");
    let last_ul=document.querySelector(".last_ul");
    let array1=[];
    let array2=sessionStorage.getItem('box')?JSON.parse(sessionStorage.getItem('box')):[];

    if(sessionStorage.getItem('box')) {
        if(array2.length>0) {
            sum1.innerHTML = array2.length;
            sum.style.display = "flex";
        }
        else if(array2.length===0){
            sum.style.display = "none";
        }
array2.forEach(function (item){
    let id=block[item.id-1];
let id_button=id.querySelector("button");
console.log(id_button);
    console.log(array2);
    id_button.style.background = "rgba(0, 168, 45, 1)";
             id_button.textContent = "В КОРЗИНЕ";

})
    }
   window.onresize=function (){
      location.reload();
   }
    let width= window.screen.width;
        if (width> 751) {
            block.forEach(function (item, i, array) {


                item.onmouseover = function () {
                    text[i].style.marginTop = "-10px";
                    price[i].style.bottom = "80px";
                    button[i].style.display = "block";
                    button[i].style.bottom = "20px";
                    button[i].style.cursor = "pointer";
                }

                item.onmouseout = function () {

                    text[i].style.marginTop = "36px";
                    price[i].style.bottom = "33px";
                    button[i].style.display = "none";
                }
            })

        }

    button.forEach(function (item, i, array) {
        item.onclick = function () {

            item.style.background = "rgba(0, 168, 45, 1)";
            item.textContent="В КОРЗИНЕ";
            sum.style.display="flex";

        }
    })






    last_ul.onmouseover = function () {

        if (sum1.textContent == "") {
            basket.style.pointerEvents = 'none';
            img_basket.style.pointerEvents = 'none';
            basket.style.color = "black";
            img_basket.style.color = "black";


        } else if (sum1.textContent >= 0){
            basket.style.pointerEvents = 'auto';
            img_basket.style.pointerEvents = 'auto';
            basket.style.cursor = "pointer";
            basket.style.color = "rgba(0, 168, 45, 1)";
            img_basket.style.color = "rgba(0, 168, 45, 1)";
            img_basket.style.cursor = "pointer";

        }
    }
    last_ul.onmouseout = function () {

        basket.style.color = "black";
        img_basket.style.color = "black";
    }



      window.addEventListener('click',function (event){


       if(event.target.dataset.action==='button') {
           let id_block = event.target.closest('.catalog_image');
           let id = id_block.getAttribute("id");
           let src = id_block.querySelector('img').getAttribute("src");
           let text = id_block.querySelector('.text').textContent;
           let price = id_block.querySelector('span.price').textContent;
           let num=1;
           let button_click=id_block.querySelector("button");





           let obj = {

               id: id,
               src: src,
               text: text,
               price: price,
               num: num
           }


     array2.forEach(function ($item,$i){

         if($item.id===obj.id ){
             obj={};
         }
     })
           if(Object.keys(obj).length !== 0){
                array2.push(obj);
                sessionStorage.setItem('box',JSON.stringify(array2));

                 sum1.innerHTML= array2.length;
               button_click.style.background = "rgba(0, 168, 45, 1)";
               button_click.textContent = "В КОРЗИНЕ";
               sum.style.display = "flex";
           }


       }


      })

    basket.addEventListener('click',function (){


        let load = function (url, callback) {
            let ajax = new XMLHttpRequest();
            ajax.open('POST', url);
            ajax.onload = function () {
                callback(this.responseText);
            }
            ajax.setRequestHeader("Content-Type", "application/json;charset=UTF-8")
            ajax.send(JSON.stringify(array2));
        }
        load('ajax/ajax.php', function (data) {
            console.log(data);

        })


    })
    basket1.addEventListener('click',function (){


        let load = function (url, callback) {
            let ajax = new XMLHttpRequest();
            ajax.open('POST', url);
            ajax.onload = function () {
                callback(this.responseText);
            }
            ajax.setRequestHeader("Content-Type", "application/json;charset=UTF-8")
            ajax.send(JSON.stringify(array2));
        }
        load('ajax/ajax.php', function (data) {
            console.log(data);

        })


})


</script>

